<head>
<title>Matter.js Basics Tutorial</title>
<meta name="author" content="John Day">
<script src="js/lib/matter.js"></script>
<!-- <script src="js/alias.js"></script> -->
<script src="js/lemming.js"></script>
<script src="js/grid.js"></script>
<script src="js/index.js"></script>
<script src="js/p5/p5.min.js"></script>

</head>
<body>

  <script>

  var Engine = Matter.Engine,
  World = Matter.World,
  Bodies = Matter.Bodies,
  Body = Matter.Body
  Constraint = Matter.Constraint,
  Composites = Matter.Composites,
  Events = Matter.Events,
  MouseConstraint = Matter.MouseConstraint,
  Composite = Matter.Composite,
  Mouse = Matter.Mouse,
  Renderer = Matter.Renderer,
  Render = Matter.Render,
  Common = Matter.Common;

  function setup() {
    createCanvas(640, 480);
  }

    // create an engine
    var engine = Engine.create();

    // // create a renderer
    var render = Render.create({
        element: document.body,
        engine: engine,
        options: {
            width: canvasSize.width,
          height: canvasSize.height,
          wireframes: false
      }
    });


    var mouse = Mouse.create(render.canvas);

    var mouseConstraint = MouseConstraint.create(engine, {mouse: mouse, constraint: {stiffness: 0.2}});
    var mouseIsDown = false;


    World.add(engine.world, [mouseConstraint]);

    Events.on(engine, 'mousedown', function(event) {
    var mousePosition = event.mouse.position;
    mouseIsDown = true;
    console.log(mousePosition)
    });

    // Events.on(engine, 'mousedown', function(event) {
    //   var mousePosition = event.mouse.position;
    //     lemming.shape.force = {
    //       x: 0.001,
    //       y: -0.01
    //       };
    //     });

    Events.on(engine, 'collisionStart', function(event){
      if (lemming.shape.velocity.x >= 0) {
        Body.setVelocity(lemming.shape, { x: 2, y: -0.5 })
      };
      if (lemming.shape.velocity.x < 0) {
        Body.setVelocity(lemming.shape, { x: -2, y: -0.5})
      };    });

    layerNodes = 40;
    layers = 20;
    grid = new Grid(layerNodes, layers);
    grid.generateBucket();
    grid.entranceBlock(2, 10);
    grid.exitBlock(37, 1);
    // for (var i = 0; i < 10; i++) {
    //   setTimeout(function(){var lemming = new Lemming(grid.spawn)}, i * 1000)
    //
    // };

    var lemming = new Lemming(grid.spawn);

    run();


  </script>
</body>
</html>
